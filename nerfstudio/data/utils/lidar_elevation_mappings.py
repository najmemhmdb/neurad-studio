# Copyright 2024 the authors of NeuRAD and contributors.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

"""Lidar elevation mappings for different sensors. Maps diode index to elevation angle in degrees."""

import numpy as np

PANDAR64_ELEVATION_MAPPING = {
    0: 14.882,
    1: 11.032,
    2: 8.059,
    3: 5.057,
    4: 3.04,
    5: 2.028,
    6: 1.86,
    7: 1.688,
    8: 1.522,
    9: 1.351,
    10: 1.184,
    11: 1.013,
    12: 0.846,
    13: 0.675,
    14: 0.508,
    15: 0.337,
    16: 0.169,
    17: 0.0,
    18: -0.169,
    19: -0.337,
    20: -0.508,
    21: -0.675,
    22: -0.846,
    23: -1.013,
    24: -1.184,
    25: -1.351,
    26: -1.522,
    27: -1.688,
    28: -1.86,
    29: -2.028,
    30: -2.198,
    31: -2.365,
    32: -2.536,
    33: -2.7,
    34: -2.873,
    35: -3.04,
    36: -3.21,
    37: -3.375,
    38: -3.548,
    39: -3.712,
    40: -3.884,
    41: -4.05,
    42: -4.221,
    43: -4.385,
    44: -4.558,
    45: -4.72,
    46: -4.892,
    47: -5.057,
    48: -5.229,
    49: -5.391,
    50: -5.565,
    51: -5.726,
    52: -5.898,
    53: -6.061,
    54: -7.063,
    55: -8.059,
    56: -9.06,
    57: -9.885,
    58: -11.032,
    59: -12.006,
    60: -12.974,
    61: -13.93,
    62: -18.889,
    63: -24.897,
}  # degrees

VELODYNE_128_ELEVATION_MAPPING = {
    0: -11.742,
    1: -1.99,
    2: 3.4,
    3: -5.29,
    4: -0.78,
    5: 4.61,
    6: -4.08,
    7: 1.31,
    8: -6.5,
    9: -1.11,
    10: 4.28,
    11: -4.41,
    12: 0.1,
    13: 6.48,
    14: -3.2,
    15: 2.19,
    16: -3.86,
    17: 1.53,
    18: -9.244,
    19: -1.77,
    20: 2.74,
    21: -5.95,
    22: -0.56,
    23: 4.83,
    24: -2.98,
    25: 2.41,
    26: -6.28,
    27: -0.89,
    28: 3.62,
    29: -5.07,
    30: 0.32,
    31: 7.58,
    32: -0.34,
    33: 5.18,
    34: -3.64,
    35: 1.75,
    36: -25.0,
    37: -2.43,
    38: 2.96,
    39: -5.73,
    40: 0.54,
    41: 9.7,
    42: -2.76,
    43: 2.63,
    44: -7.65,
    45: -1.55,
    46: 3.84,
    47: -4.85,
    48: 3.18,
    49: -5.51,
    50: -0.12,
    51: 5.73,
    52: -4.3,
    53: 1.09,
    54: -16.042,
    55: -2.21,
    56: 4.06,
    57: -4.63,
    58: 0.76,
    59: 15.0,
    60: -3.42,
    61: 1.97,
    62: -6.85,
    63: -1.33,
    64: -5.62,
    65: -0.23,
    66: 5.43,
    67: -3.53,
    68: 0.98,
    69: -19.582,
    70: -2.32,
    71: 3.07,
    72: -4.74,
    73: 0.65,
    74: 11.75,
    75: -2.65,
    76: 1.86,
    77: -7.15,
    78: -1.44,
    79: 3.95,
    80: -2.1,
    81: 3.29,
    82: -5.4,
    83: -0.01,
    84: 4.5,
    85: -4.19,
    86: 1.2,
    87: -13.565,
    88: -1.22,
    89: 4.17,
    90: -4.52,
    91: 0.87,
    92: 6.08,
    93: -3.31,
    94: 2.08,
    95: -6.65,
    96: 1.42,
    97: -10.346,
    98: -1.88,
    99: 3.51,
    100: -6.06,
    101: -0.67,
    102: 4.72,
    103: -3.97,
    104: 2.3,
    105: -6.39,
    106: -1.0,
    107: 4.39,
    108: -5.18,
    109: 0.21,
    110: 6.98,
    111: -3.09,
    112: 4.98,
    113: -3.75,
    114: 1.64,
    115: -8.352,
    116: -2.54,
    117: 2.85,
    118: -5.84,
    119: -0.45,
    120: 8.43,
    121: -2.87,
    122: 2.52,
    123: -6.17,
    124: -1.66,
    125: 3.73,
    126: -4.96,
    127: 0.43,
}  # degrees

VELODYNE_VLP32C_ELEVATION_MAPPING = {
    0: -25.0,
    1: -1.0,
    2: -1.667,
    3: -15.639,
    4: -11.31,
    5: 0.0,
    6: -0.667,
    7: -8.843,
    8: -7.254,
    9: 0.333,
    10: -0.333,
    11: -6.148,
    12: -5.333,
    13: 1.333,
    14: 0.667,
    15: -4.0,
    16: -4.667,
    17: 1.667,
    18: 1.0,
    19: -3.667,
    20: -3.333,
    21: 3.333,
    22: 2.333,
    23: -2.667,
    24: -3.0,
    25: 7.0,
    26: 4.667,
    27: -2.333,
    28: -2.0,
    29: 15.0,
    30: 10.333,
    31: -1.333,
}

ARGOVERSE2_VELODYNE_VLP32C_ELEVATION_MAPPING = {
    31: -25.0,
    13: -1.0,
    1: -1.667,
    17: -15.639,
    29: -11.31,
    9: 0.0,
    3: -0.667,
    21: -8.843,
    27: -7.254,
    12: 0.333,
    5: -0.333,
    16: -6.148,
    25: -5.333,
    8: 1.333,
    7: 0.667,
    20: -4.0,
    22: -4.667,
    2: 1.667,
    10: 1.0,
    28: -3.667,
    23: -3.333,
    6: 3.333,
    11: 2.333,
    24: -2.667,
    18: -3.0,
    0: 7.0,
    14: 4.667,
    30: -2.333,
    19: -2.0,
    4: 15.0,
    15: 10.333,
    26: -1.333,
}

VELODYNE_HDL32E_ELEVATION_MAPPING = dict(zip(np.arange(32), tuple(np.linspace(-30.67, 10.67, 32))))

WOD64_ELEVATION_MAPPING = {
    0: 2.5028389775650304,
    1: 2.321411751659905,
    2: 2.160192256145731,
    3: 1.9888398480248883,
    4: 1.8209349283573786,
    5: 1.6502418044970433,
    6: 1.4938679389287557,
    7: 1.3221564279311344,
    8: 1.1632512247221256,
    9: 0.9913750200128197,
    10: 0.8101498633691424,
    11: 0.6482041237244122,
    12: 0.48336997052669073,
    13: 0.3201589105532588,
    14: 0.16462286430089693,
    15: -0.011621928777127347,
    16: -0.1892787856748749,
    17: -0.34201145065403127,
    18: -0.5054471288374568,
    19: -0.6827621682735187,
    20: -0.8449790324744345,
    21: -1.0197501521052226,
    22: -1.1886280361746464,
    23: -1.3669402000816122,
    24: -1.5409274243550963,
    25: -1.7570629940063032,
    26: -1.9649363657632477,
    27: -2.1894398590475905,
    28: -2.4374471868305987,
    29: -2.6683997977793497,
    30: -2.9254801778651274,
    31: -3.208793362354923,
    32: -3.4652440977914574,
    33: -3.770654905928011,
    34: -4.068046596015399,
    35: -4.365557254206326,
    36: -4.68136205944531,
    37: -5.023904856877318,
    38: -5.360837632630594,
    39: -5.715495138382295,
    40: -6.091110098376429,
    41: -6.457270941426794,
    42: -6.8451480987631,
    43: -7.24803061771811,
    44: -7.645534995724646,
    45: -8.08179034271091,
    46: -8.522502366939104,
    47: -8.957247796204939,
    48: -9.421474930460981,
    49: -9.885265834826649,
    50: -10.369068098135806,
    51: -10.829727642824542,
    52: -11.332199121554261,
    53: -11.822915504645561,
    54: -12.364441979859368,
    55: -12.908557767713962,
    56: -13.437836414956127,
    57: -13.983840803683233,
    58: -14.537462865288743,
    59: -15.076443690248071,
    60: -15.689281398977771,
    61: -16.300273448699592,
    62: -16.911934322750316,
    63: -17.546811286086175,
}  # degrees
